# zaboy-installer

---
## [Оглавление](https://github.com/avz-cmf/Server-Drakon/blob/master/Table%20of%20contents.md)
---

Библиотека install позволяет произвести настройку окружение для вашей библиотеки или приложения.   

Для того что бы настроить окружение вы должны создать класс `InstallCommands` который будет наследовать
абстрактный класс `AbstractCommand`. 
Данный клас должен находиться на самом верхнем уровне `namespace` вашего приложения в дериктории `src`.

Теперь вы должны создать реализации интерфейса `InstallerInterface` в которых и будет описана процедура настройки окружения.
Данные реализации обязаны содержать в себе суфикс `Installer`.

При запуске инсталяции, будут найдены все подобные инсталлеры в порядке **сверху вниз**.
> Учитывайте это при напсании своих инсталлеров если вам важен порядок их вызова. 

Данная библиотека позволяет настраивать окружение для зависимых библиотек, но не гарантирует порядок выполнения данной настройки.


## Переменные окружения

Для обозначения типа рабочего окружения используется переменная окружения `APP_EVN` 
Используйте ее что бы определять для какого окружение происходит настройка.

Так же должны быть переменная `SERVICE_MACHINE_NAME` которая должна содержать в себе имя текущей контейнера/машины.  
Она должна содержать имя в таком виде  `{server_name}-{vm_name}-{container_name}`.  
В случае если одной составляющей из данной цепочи не существует - пропустите ее.  
Пример:
* `ServerDrakon-ProductionVM-5000`
* `ServerDrakon-ProductionVM-`
* `ServerDrakon--5000`
* `ServerDrakon--`
 
 
## Запуск установщиков
  
Для того что бы можно было запускать инсталлеры используя композер вы должны добавить следующий учаток кода в секцию 
`scripts` файла `composer.json`
 ```json
   {
      "scripts": {
        "lib-install": "zaboy\\InstallCommands::install",
        "lib-uninstall": "zaboy\\InstallCommands::uninstall",
        "lib-reinstall": "zaboy\\InstallCommands::reinstall"
      }
   }
 ```
> Без обромляющих символов `{` и `}`. И замените `zaboy` своим namespace

Теперь после того как все предыдущее шаги были сделаны, вы можете используя команды 
* `composer lib-install` - Запускать инсталяторы для настрройки окружения. 
* `composer lib-uninstall` - Удалять настроки окружения.
* `composer lib-reinstall` - Переустанавливать окружения.  


